<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><title>10. Running a Server</title><link rel="stylesheet" type="text/css" href="../style.css"></head><body><div class="header"><table><tr><td align="left"><a href="options.html">Previous</a></td><td align="center"><a href="index.html">Contents</a></td><td align="right"><a href="building.html">Next</a></td></tr></table></div><h2>10. Running a Server</h2><p>This section describes how to run your own online <i>Knights</i> server.</p><h3>Installation</h3><p>For Windows, the <i>Knights</i> server program is available as a separate download from the <i>Knights</i> web site. The file should be unzipped to a directory of your choice, and then you can run the server from the command line by cd-ing into that directory and typing &quot;knights_server&quot;.</p><p>For Linux, the server is built and installed automatically as part of the normal build process. To run the server type &quot;knights_server&quot; on the command line.</p><h3>The configuration file</h3><p>The server needs to read a configuration file before it can run. The default is to look for a file named &quot;knights_config.txt&quot; in the current directory. If you want to use a different config file you can specify it using the -c option, for example:</p><p><code>knights_server -c path/to/my_config.txt</code></p><p>The file itself is a plain text file consisting of &quot;Setting = Value&quot; pairs, for example, &quot;MaxPlayers = 50&quot;. There is one setting per line. Comment lines may also be included by starting them with a # symbol. An example knights_config.txt file is included in the distribution and you are encouraged to use this as a basis for creating your own config file.</p><p>Please note that changes to the config file will not take effect until the server is restarted.</p><p>The full list of settings is as follows:</p><ul><li><b>Description:</b> A short description of the server. This will appear in the game on the &quot;Connect to Server&quot; screen.</li><li><b>KnightsDataDir:</b> Specifies the location of the &quot;knights_data&quot; directory. If you have followed the standard install procedure then the game will find the directory automatically and this can be left unset; if you have installed the knights_data directory in a non-standard location then you can use this setting to tell the server where to find it.</li><li><b>LogFile:</b> Gives the name of a log file. The server will append log messages to the end of the file. Events logged include player connections/disconnections, games played, and all chat messages. If this parameter is unset then log messages will be printed on stdout.</li><li><b>MaxGames:</b> Sets a maximum number of games that can exist at any given time. If this number of games is reached then the server will not create any new games until the number drops down below the maximum again.</li><li><b>MaxPlayers:</b> Maximum number of players that can connect to the server at any one time. Default is 100.</li><li><b>MOTDFile:</b> Set to the name of a text file containing a Message Of The Day which will be displayed when players first connect to the server. The server re-reads the file each time a player connects, so you can edit the contents of the file without having to restart the server.</li><li><b>OldMOTDFile:</b> As MOTDFile, except that the OldMOTDFile will only be displayed if the client is running an older version of <i>Knights</i>. Can be used to display a message that a new version of <i>Knights</i> is available. Default: same as MOTDFile. (Note that it is not guaranteed that old client versions will be compatible with new server versions; in general, it is recommended to keep the client and server versions the same, if at all possible.)</li><li><b>Password:</b> If set, the server will be password protected and players must type in the password before they can connect. Please note that the passwords are <i>not</i> encrypted during transmission, so be careful not to use anything confidential as the password.</li><li><b>Port:</b> Which UDP port to use. The server listens for incoming connections on this port. Default 16399.</li><li><b>UseBroadcast:</b> This should be set to &quot;yes&quot; for a private, LAN-only server. Players on the local network will be able to see the server listed on their &quot;Connect to Server&quot; screen, but players on the wider Internet will not. (This is implemented by having the client send out broadcasts on UDP port 16398, which the server will then respond to.)</li><li><b>UseMetaserver:</b> This should be set to &quot;yes&quot; for a public server. Players across the internet will be able to see the server listed on their &quot;Connect to Server&quot; screen. (This is implemented by connecting to a &quot;metaserver&quot; running on the knightsgame.org.uk web site.)</li></ul><p>Note that players connecting to the server must be running the same version of <i>Knights</i> that the server is using. If the versions do not match then the connection will be refused.</p><h4>Experimental features</h4><p>The following options allow games played on the server to be recorded, and then replayed at a later date. Note that the playback feature is highly experimental, and may not work very well. At the moment it is mostly only useful for debugging (i.e. if a player reports a bug, then we can go back and analyse the recording to try to work out what happened). It may be expanded to be more generally useful in the future.</p><ul><li><b>BinaryLog:</b> Specify a filename to log game data to. If the file exists, the new data will be appended, otherwise a new file will be created.</li><li><b>Replay:</b> Specify the name of a file that was created with the BinaryLog option. The server will replay all the games that were recorded in the file. To watch the games, you can start up a copy of Knights and join the server as an observer.</li></ul><h3>Suggestions</h3><p>Here are some suggested ways of using the server.</p><ul><li><b>Public Internet server.</b> Start your own public <i>Knights</i> server. The default settings should be fine, although you may want to set a &quot;Description&quot; and/or &quot;MOTDFile&quot;.</li><li><b>LAN server.</b> For a LAN party (for example) you might want to run a separate server instead of using the &quot;Host LAN Game&quot; option. (The advantage of this is that you avoid the issue where all players get disconnected whenever the &quot;host&quot; player quits.) To run a LAN server, set &quot;UseBroadcast&quot; to &quot;yes&quot; and &quot;UseMetaserver&quot; to &quot;no&quot;. The server will not appear in the public server list but it will appear to players on the current LAN.</li><li><b>Private Internet server.</b> If you want to run a private Internet server there are two methods: <ul><li>Set &quot;UseMetaserver&quot; to &quot;no&quot;. Your server will then not appear in the public server list; the only way for players to connect will be by typing the server&#39;s IP address directly into the Connect to Server screen.</li><li>Leave &quot;UseMetaserver&quot; set to &quot;yes&quot;, but set a password. Your server will appear in the global server list, but only players who know the password will be able to log in.</li></ul></li></ul><h3>Keeping the server running</h3><p>The distribution contains a Unix shell script, start_knights_server.sh, which checks whether the server is running, and if not, starts a new copy of the server. This allows the server to be automatically re-started in the event that it crashes. For instructions read the comments within the file.</p><div class="footer2"><table><tr><td align="left"><a href="options.html">Previous</a></td><td align="center"><a href="index.html">Contents</a></td><td align="right"><a href="building.html">Next</a></td></tr><tr><td align="left">Game Options</td><td></td><td align="right">Building/Installing from Source</td></tr></table></div></body></html>